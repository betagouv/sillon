"use strict";(self.webpackChunksillon=self.webpackChunksillon||[]).push([[9467],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var u=n.createContext({}),l=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},c=function(e){var t=l(e.components);return n.createElement(u.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},f=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=l(r),f=a,m=p["".concat(u,".").concat(f)]||p[f]||d[f]||o;return r?n.createElement(m,s(s({ref:t},c),{},{components:r})):n.createElement(m,s({ref:t},c))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=f;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i[p]="string"==typeof e?e:a,s[1]=i;for(var l=2;l<o;l++)s[l]=r[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}f.displayName="MDXCreateElement"},915:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var n=r(7462),a=(r(7294),r(3905));const o={hide_table_of_contents:!0},s="Un seul espace de stockage, \xe7a serait le r\xeave ?",i={unversionedId:"database-for-everything/dream-of-unique-storage",id:"database-for-everything/dream-of-unique-storage",title:"Un seul espace de stockage, \xe7a serait le r\xeave ?",description:"Ce qui est le plus compliqu\xe9 quand on g\xe8re de l'op\xe9rationnel ce n'est pas le stateless (normalement \xe9quivalent \xe0 votre code JS qui tourne), mais le stateful (partout o\xf9 vous avez de la donn\xe9e stock\xe9e).",source:"@site/docs/database-for-everything/dream-of-unique-storage.mdx",sourceDirName:"database-for-everything",slug:"/database-for-everything/dream-of-unique-storage",permalink:"/docs/database-for-everything/dream-of-unique-storage",draft:!1,editUrl:"https://github.com/betagouv/sillon/tree/main/docs/database-for-everything/dream-of-unique-storage.mdx",tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"docs",previous:{title:"PostgreSQL plut\xf4t que MySQL",permalink:"/docs/database-for-everything/postgresql-rather-than-mysql"},next:{title:"Stockage de fichiers (au revoir buckets S3)",permalink:"/docs/database-for-everything/file-storage"}},u={},l=[],c={toc:l},p="wrapper";function d(e){let{components:t,...r}=e;return(0,a.kt)(p,(0,n.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"un-seul-espace-de-stockage-\xe7a-serait-le-r\xeave-"},"Un seul espace de stockage, \xe7a serait le r\xeave ?"),(0,a.kt)("p",null,"Ce qui est le plus compliqu\xe9 quand on g\xe8re de l'op\xe9rationnel ce n'est pas le stateless (normalement \xe9quivalent \xe0 votre code JS qui tourne), mais le ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/State_(computer_science)"},"stateful")," (partout o\xf9 vous avez de la donn\xe9e stock\xe9e)."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Si votre stateless est bien con\xe7u (gestion du ",(0,a.kt)("a",{parentName:"li",href:"https://fr.wikipedia.org/wiki/SIGTERM"},"SIGTERM"),", transactions de base de donn\xe9es\u2026), qu'il y ait 1, 2, 3 instances voire m\xeame 0 cela ne perturbe en rien ce qui est vital : les donn\xe9es utilisateurs ;"),(0,a.kt)("li",{parentName:"ul"},"Si votre stateless est supprim\xe9 par m\xe9garde, vous pouvez le repeupler et il remplira toujours sa fonction primaire ;")),(0,a.kt)("p",null,"Par contre\u2026 si votre stateful est instable il y a un risque qu'il y ait une corruption de donn\xe9es (risque limit\xe9 avec l'usage des transactions, mais \xe7a peut arriver dans un fil d'ex\xe9cution qui appelle diff\xe9rent outils stateful). Et si par m\xe9garde vous le supprimez, il faut rentrer dans une longue investigation."),(0,a.kt)("p",null,"Par chance vous aurez ",(0,a.kt)("a",{parentName:"p",href:"/docs/backups/"},"mis en place des backups")," mais entre le dernier backup et la perte des donn\xe9es il va \xeatre tr\xe8s dur de reconstituer ce qui manque (voire impossible)."),(0,a.kt)("admonition",{title:"Tout \xe7a pour dire quoi ?",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"C'est d\xe9j\xe0 assez compliqu\xe9 et stressant de g\xe9rer un outil stateful, alors il va de soi que si vous les multipliez vous ne faites pas un cadeau \xe0 la partie op\xe9rationnelle de l'\xe9quipe.")),(0,a.kt)("p",null,"Dans les parties suivantes nous allons essayer de vous convaincre que se servir de votre PostgreSQL comme d'un couteau-suisse peut vous simplifier la vie."))}d.isMDXComponent=!0}}]);