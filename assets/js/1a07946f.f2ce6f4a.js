"use strict";(self.webpackChunksillon=self.webpackChunksillon||[]).push([[9186],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>v});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=a(e,["components","mdxType","originalType","parentName"]),d=p(n),m=o,v=d["".concat(l,".").concat(m)]||d[m]||c[m]||i;return n?r.createElement(v,s(s({ref:t},u),{},{components:n})):r.createElement(v,s({ref:t},u))}));function v(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,s=new Array(i);s[0]=m;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a[d]="string"==typeof e?e:o,s[1]=a;for(var p=2;p<i;p++)s[p]=n[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},396:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>i,metadata:()=>a,toc:()=>p});var r=n(7462),o=(n(7294),n(3905));const i={hide_table_of_contents:!0},s="Avoir diff\xe9rents environnements",a={unversionedId:"environments/index",id:"environments/index",title:"Avoir diff\xe9rents environnements",description:"Combien n\xe9cessaires ?",source:"@site/docs/environments/index.mdx",sourceDirName:"environments",slug:"/environments/",permalink:"/docs/environments/",draft:!1,editUrl:"https://github.com/betagouv/sillon/tree/main/docs/environments/index.mdx",tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"docs",previous:{title:"L'int\xe9gration et le d\xe9ploiement continu (CI/CD)",permalink:"/docs/continuous-integration-and-continuous-deployment/"},next:{title:"Les tests et la limite du mock",permalink:"/docs/tests-and-the-mock-limit/"}},l={},p=[{value:"Combien n\xe9cessaires ?",id:"combien-n\xe9cessaires-",level:2},{value:"Production",id:"production",level:3},{value:"Development",id:"development",level:3},{value:"Staging",id:"staging",level:3},{value:"Comment \xe7a s&#39;organise ?",id:"comment-\xe7a-sorganise-",level:2}],u={toc:p},d="wrapper";function c(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"avoir-diff\xe9rents-environnements"},"Avoir diff\xe9rents environnements"),(0,o.kt)("h2",{id:"combien-n\xe9cessaires-"},"Combien n\xe9cessaires ?"),(0,o.kt)("h3",{id:"production"},"Production"),(0,o.kt)("p",null,"Cela va d\xe9pendre de votre produit et de vos pr\xe9f\xe9rences. Par exemple, quand vous r\xe9digez un article sur un blog, il est fort probable que vous fassiez vos modifications directement sur ce qu'on pourrait appeler \"environnement de ",(0,o.kt)("strong",{parentName:"p"},"production"),"\". Et cela s'y porte tr\xe8s bien, car l'outil reste peu complexe et la prise de risque est donc faible."),(0,o.kt)("h3",{id:"development"},"Development"),(0,o.kt)("p",null,"Quand vous faites du d\xe9veloppement informatique (avec une \xe9quipe de plus d'1 personne), il y a un moment o\xf9 vous voulez normalement montrer ce qui a \xe9t\xe9 d\xe9velopp\xe9 \xe0 des personnes associ\xe9es au projet, aussi pour qu'elles testent avec des v\xe9rifications manuelles. Il est peu probable que des personnes non-techniques t\xe9l\xe9chargent le code technique, installent ce qu'il faut (base de donn\xe9es\u2026), pour enfin lancer le produit localement et pouvoir le tester. Le plus simple est donc de leur mettre \xe0 disposition un environnement de ",(0,o.kt)("strong",{parentName:"p"},"d\xe9veloppement")," (ou de ",(0,o.kt)("strong",{parentName:"p"},"test"),", suivant votre nommage)."),(0,o.kt)("p",null,'Il peut \xeatre int\xe9ressant de le diff\xe9rencier de la production via un bandeau dans le header pour \xe9viter de malencontreuses actions. Et aussi de sensibiliser les testeurs sur le fait d\'utiliser des donn\xe9es "fake" non-sensibles car cet environnement peut \xeatre manipul\xe9 par plus de monde que la production.'),(0,o.kt)("p",null,"Aussi, si le code est open source et que personne n'utilise ses donn\xe9es personnelles, il n'est pas n\xe9cessaire de vous emb\xeater \xe0 le mettre derri\xe8re un proxy type ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/oauth2-proxy/oauth2-proxy"},(0,o.kt)("inlineCode",{parentName:"a"},"oauth2-proxy")),". Pour la s\xe9curit\xe9 :"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Il est surtout important de ne pas utiliser les m\xeames instances (applicatif et stockage) que la production en cas d'infiltration ;"),(0,o.kt)("li",{parentName:"ul"},"Pour mitiger le risque de donn\xe9es sensibles oubli\xe9es dedans vous pourriez tous les X mois faire un reset avec ",(0,o.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Database_seeding"},"un jeu de donn\xe9es de test"),".")),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},'L\'environnement de d\xe9veloppement peut cohabiter avec des environnements \xe9ph\xe9m\xe8res (par fonctionnalit\xe9 d\xe9velopp\xe9e, souvent appel\xe9s "review apps"), voire m\xeame \xeatre remplac\xe9 par ceux-ci.')),(0,o.kt)("h3",{id:"staging"},"Staging"),(0,o.kt)("p",null,"Certains projets ont un environnement de ",(0,o.kt)("strong",{parentName:"p"},"recette")," interm\xe9diaire entre ",(0,o.kt)("inlineCode",{parentName:"p"},"development")," et ",(0,o.kt)("inlineCode",{parentName:"p"},"production"),", qui est cens\xe9 repr\xe9senter la production sans pourtant l'\xeatre, avec des jeux de donn\xe9es de production anonymis\xe9s par exemple. Ce qui veut dire qu'une modification doit passer ",(0,o.kt)("inlineCode",{parentName:"p"},"development \u2192 staging \u2192 production"),", rajoutant une \xe9tape de test qui n'est pas forc\xe9ment soutenable pour une \xe9quipe."),(0,o.kt)("p",null,"L'utilit\xe9 du ",(0,o.kt)("inlineCode",{parentName:"p"},"staging")," va surtout d\xe9pendre de la criticit\xe9 de votre projet. Si vous pouvez vous permettre de parfois pousser des erreurs en ayant l'agilit\xe9 de les corriger rapidement, n'avoir que ",(0,o.kt)("inlineCode",{parentName:"p"},"development + production")," permet de rester simple."),(0,o.kt)("h2",{id:"comment-\xe7a-sorganise-"},"Comment \xe7a s'organise ?"),(0,o.kt)("p",null,"Les environnements sont souvent diff\xe9renci\xe9s par des branches Git diff\xe9rentes, qui, \xe0 chaque commit, seront d\xe9ploy\xe9es."),(0,o.kt)("p",null,'Il y a pas mal de standards pour g\xe9rer \xe0 la fois les environnements "runtime", ainsi que les branches correctives ou de fonctionnalit\xe9s (',(0,o.kt)("a",{parentName:"p",href:"https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow"},"Gitflow"),", ",(0,o.kt)("a",{parentName:"p",href:"https://docs.github.com/en/get-started/quickstart/github-flow"},"GitHub flow"),", ",(0,o.kt)("a",{parentName:"p",href:"https://about.gitlab.com/topics/version-control/what-is-gitlab-flow/"},"Gitlab flow"),"\u2026). Nous choisissons ",(0,o.kt)("a",{parentName:"p",href:"https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow"},"Gitflow")," comme base en l'adaptant en fonction des phases d'avancement du projet (peut-\xeatre pas besoin des branches ",(0,o.kt)("inlineCode",{parentName:"p"},"release"),", peut-\xeatre pas besoin de branches de ",(0,o.kt)("inlineCode",{parentName:"p"},"feature")," si qu'un seul d\xe9veloppeur\u2026). ",(0,o.kt)("strong",{parentName:"p"},"L'important est d'\xeatre \xe0 l'aise pour \xe9viter de perdre du temps, conciliez-vous au d\xe9but du projet.")))}c.isMDXComponent=!0}}]);