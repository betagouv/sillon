"use strict";(self.webpackChunksillon=self.webpackChunksillon||[]).push([[7801],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=r.createContext({}),l=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(u.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,u=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=l(n),d=o,f=c["".concat(u,".").concat(d)]||c[d]||m[d]||i;return n?r.createElement(f,a(a({ref:t},p),{},{components:n})):r.createElement(f,a({ref:t},p))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=d;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s[c]="string"==typeof e?e:o,a[1]=s;for(var l=2;l<i;l++)a[l]=n[l];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8786:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>a,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=n(7462),o=(n(7294),n(3905));const i={hide_table_of_contents:!0},a="L'int\xe9gration et le d\xe9ploiement continu (CI/CD)",s={unversionedId:"continuous-integration-and-continuous-deployment/index",id:"continuous-integration-and-continuous-deployment/index",title:"L'int\xe9gration et le d\xe9ploiement continu (CI/CD)",description:"Nous pr\xe9conisons d'utiliser une pipeline de CI/CD d\xe9crite dans votre repository. Si votre repository est par exemple sur GitHub nous ne voyons pas l'utilit\xe9 d'utiliser un outil tiers comme CircleCI plut\xf4t que GitHub Actions (comme \xe7a au moins vous avez tout dans un m\xeame endroit).",source:"@site/docs/continuous-integration-and-continuous-deployment/index.mdx",sourceDirName:"continuous-integration-and-continuous-deployment",slug:"/continuous-integration-and-continuous-deployment/",permalink:"/docs/continuous-integration-and-continuous-deployment/",draft:!1,editUrl:"https://github.com/betagouv/sillon/tree/main/docs/continuous-integration-and-continuous-deployment/index.mdx",tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"docs",previous:{title:"Authentifier les utilisateurs",permalink:"/docs/user-authentication/"},next:{title:"Avoir diff\xe9rents environnements",permalink:"/docs/environments/"}},u={},l=[],p={toc:l},c="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"lint\xe9gration-et-le-d\xe9ploiement-continu-cicd"},"L'int\xe9gration et le d\xe9ploiement continu (CI/CD)"),(0,o.kt)("p",null,"Nous pr\xe9conisons d'utiliser une pipeline de ",(0,o.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/CI/CD"},"CI/CD")," d\xe9crite dans votre repository. Si votre repository est par exemple sur GitHub nous ne voyons pas l'utilit\xe9 d'utiliser un outil tiers comme ",(0,o.kt)("a",{parentName:"p",href:"https://circleci.com/"},"CircleCI")," plut\xf4t que ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/features/actions"},"GitHub Actions")," (comme \xe7a au moins vous avez tout dans un m\xeame endroit)."),(0,o.kt)("p",null,"Sauf exception, ",(0,o.kt)("strong",{parentName:"p"},"l'important est de ne surtout pas essayer de g\xe9rer vos propres workers (serveurs) de CI/CD"),". Pourquoi ? Votre pipeline proc\xe8de normalement ainsi :"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Je r\xe9cup\xe8re le code source ;"),(0,o.kt)("li",{parentName:"ol"},"Je t\xe9l\xe9charge les d\xe9pendances ;"),(0,o.kt)("li",{parentName:"ol"},'Je "lint" le projet (pour \xeatre s\xfbr qu\'il est statiquement valide) ;'),(0,o.kt)("li",{parentName:"ol"},"Je fais mes tests unitaires avec ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/jestjs/jest"},"Jest")," ;"),(0,o.kt)("li",{parentName:"ol"},'Je "build" mon projet ;'),(0,o.kt)("li",{parentName:"ol"},"Je fais mes tests d'int\xe9gration end-to-end avec ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/cypress-io/cypress"},"Cypress")," ",(0,o.kt)("em",{parentName:"li"},"(on ne les recommande pas, ils sont tr\xe8s lourds \xe0 maintenir pour un gain limit\xe9 compar\xe9 \xe0 ",(0,o.kt)("a",{parentName:"em",href:"https://docs.google.com/document/d/1jOwMgouNtsnaqlQB139jzoA5synRfIjhtuUFrHK65-U"},"utiliser Storybook pour d\xe9crire son applicatif"),")")," ;"),(0,o.kt)("li",{parentName:"ol"},"Je d\xe9ploie mon applicatif sur l'h\xe9bergeur ;")),(0,o.kt)("p",null,"Toutes ces phases sont tr\xe8s consommatrices en ressources (CPU, m\xe9moire, stockage, r\xe9seau). Sachant que si vous faites plusieurs ",(0,o.kt)("inlineCode",{parentName:"p"},"push")," \xe0 la suite vous lancez plusieurs fois la m\xeame pipeline, et sachant aussi que vous avez peut-\xeatre plusieurs projets sur vos workers :"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Il faut g\xe9rer proprement un cache pour les d\xe9pendances en fonction de chaque technologie de projet ",(0,o.kt)("em",{parentName:"li"},"(dans notre cas \xe7a se limiterait \xe0 JavaScript)")," ;"),(0,o.kt)("li",{parentName:"ul"},"Si les CPU saturent tout va lentement, exceptionnellement si vous \xeates sur Kubernetes et que vous avez un op\xe9rateur, vous allez avoir un nouveau worker qui va \xeatre mis sur pied (mais \xe7a va prendre quelques minutes) ;"),(0,o.kt)("li",{parentName:"ul"},"Si la RAM sature, l\xe0 c'est le worker qui crash car\u2026 \"",(0,o.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Out_of_memory"},"Out of memory"),'", il faut relancer la pipeline ;'),(0,o.kt)("li",{parentName:"ul"},"Et le pire dans tout \xe7a, c'est que vous pouvez essayer de dimensionner les workers en fonction d'une utilisation intensive, mais finalement vous vous retrouvez avec des machines qui servent r\xe9ellement que 5% du temps ou moins.")),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Si vous disposez d'une messagerie interne comme Mattermost ou Slack nous vous conseillons de brancher la pipeline de votre projet sur un channel type ",(0,o.kt)("inlineCode",{parentName:"p"},"monprojet-monitoring")," afin d'\xeatre s\xfbr de ne rien manquer de la vie technique du projet.")))}m.isMDXComponent=!0}}]);