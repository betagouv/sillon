"use strict";(self.webpackChunksillon=self.webpackChunksillon||[]).push([[316],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>f});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var u=n.createContext({}),l=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=l(e.components);return n.createElement(u.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,u=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=l(r),m=a,f=c["".concat(u,".").concat(m)]||c[m]||d[m]||i;return r?n.createElement(f,s(s({ref:t},p),{},{components:r})):n.createElement(f,s({ref:t},p))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,s=new Array(i);s[0]=m;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o[c]="string"==typeof e?e:a,s[1]=o;for(var l=2;l<i;l++)s[l]=r[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},6442:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var n=r(7462),a=(r(7294),r(3905));const i={hide_table_of_contents:!0},s="Configurer les headers HTTP",o={unversionedId:"security/http-headers",id:"security/http-headers",title:"Configurer les headers HTTP",description:"Les headers HTTP venant de votre serveur vont dicter aux navigateurs internet comment ils peuvent agir (ou non). Certains doivent \xeatre r\xe9gl\xe9s pour limiter les risques li\xe9s \xe0 la s\xe9curit\xe9. Le plus simple est d'utiliser un outil comme Helmet.js pour d\xe9finir par d\xe9faut la meilleure configuration \xe0 appliquer.",source:"@site/docs/security/http-headers.mdx",sourceDirName:"security",slug:"/security/http-headers",permalink:"/docs/security/http-headers",draft:!1,editUrl:"https://github.com/betagouv/sillon/tree/main/docs/security/http-headers.mdx",tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"docs",previous:{title:"Audits de s\xe9curit\xe9",permalink:"/docs/security/security-audits"},next:{title:"S\xe9curiser les URLs des fichiers h\xe9berg\xe9s",permalink:"/docs/security/secure-hosted-files-urls"}},u={},l=[],p={toc:l},c="wrapper";function d(e){let{components:t,...r}=e;return(0,a.kt)(c,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"configurer-les-headers-http"},"Configurer les headers HTTP"),(0,a.kt)("p",null,"Les headers HTTP venant de votre serveur vont dicter aux navigateurs internet comment ils peuvent agir (ou non). Certains doivent \xeatre r\xe9gl\xe9s pour limiter les risques li\xe9s \xe0 la s\xe9curit\xe9. Le plus simple est d'utiliser un outil comme ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/helmetjs/helmet"},"Helmet.js")," pour d\xe9finir par d\xe9faut la meilleure configuration \xe0 appliquer."),(0,a.kt)("p",null,"Comme avec Next.js vous n'interagissez pas directement avec le serveur Express afin de garder l'optimisation native du serveur web, et qu'Helmet.js ne propose pas de plugin Next.js, notre solution est pour l'instant de configurer dans votre ",(0,a.kt)("inlineCode",{parentName:"p"},"next.config.js")," la propri\xe9t\xe9 ",(0,a.kt)("inlineCode",{parentName:"p"},"headers")," afin de renseigner ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/helmetjs/helmet#reference"},"toutes les valeurs par d\xe9faut de Helmet.js"),"."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Pour chaque nouvelle ressource utilis\xe9e et h\xe9berg\xe9e sur un autre domaine vous devrez ajuster les propri\xe9t\xe9s du header ",(0,a.kt)("inlineCode",{parentName:"p"},"Content-Security-Policy")," (type ",(0,a.kt)("inlineCode",{parentName:"p"},"default-src"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"img-src")," ",(0,a.kt)("inlineCode",{parentName:"p"},"script-src"),"\u2026). La console de votre navigateur vous pr\xe9viendra que le header du serveur n'est pas assez permissif.")),(0,a.kt)("p",null,"Concernant les headers entrants vous ne devriez pas \xeatre \xe0 risque puisqu'en suivant ",(0,a.kt)("a",{parentName:"p",href:"/docs/simple-and-sovereign-cloud-provider/"},"nos recommandations d'h\xe9bergement")," vous ne g\xe9rez pas vous-m\xeame la partie routage (qui se fait habituellement avec du Nginx, HAProxy, Istio\u2026). Portez toutefois une attention particuli\xe8re si vous vous basez sur l'IP du client pour authentifier une action (cela est parfois vrai pour les webhooks qui n'utilisent pas encore la signature du payload). Le formatage du header transmettant la cha\xeene d'IPs n'est pas la m\xeame en fonction des contextes (\xe0 cause des outils). Nous conseillons la lecture de ",(0,a.kt)("a",{parentName:"p",href:"https://adam-p.ca/blog/2022/03/x-forwarded-for/"},"cet article")," (l'auteur a r\xe9alis\xe9 ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/realclientip/realclientip-go"},"une librairie en Golang")," mais nous ne sommes pas au fait d'un \xe9quivalent en JavaScript)."))}d.isMDXComponent=!0}}]);